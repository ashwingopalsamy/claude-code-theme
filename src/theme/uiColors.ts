import type { WorkbenchColors, ThemeContext } from '../types';
import { opacity, transparent } from './utilities';

export function getUiColors(context: ThemeContext): WorkbenchColors {
  const { palette, ansiColors } = context;
  const isDark = palette.type === 'dark';
  const selectionAlpha = isDark ? 0.26 : 0.18;
  const softSelectionAlpha = isDark ? 0.16 : 0.1;
  const lineAlpha = isDark ? 0.12 : 0.08;

  const bracketColors = [
    palette.syntax.keyword,
    palette.syntax.function,
    palette.syntax.number,
    palette.syntax.string,
    palette.syntax.namespace,
    palette.syntax.constant,
  ];

  return {
    foreground: palette.foreground,
    disabledForeground: palette.foregroundSubtle,
    descriptionForeground: palette.foregroundMuted,
    errorForeground: palette.status.error,
    'icon.foreground': palette.foregroundMuted,
    focusBorder: palette.accent,
    'widget.shadow': isDark ? '#00000080' : '#00000020',

    'window.activeBorder': transparent,
    'window.inactiveBorder': transparent,

    'titleBar.activeBackground': palette.backgroundAlt,
    'titleBar.activeForeground': palette.foregroundMuted,
    'titleBar.inactiveBackground': palette.backgroundAlt,
    'titleBar.inactiveForeground': palette.foregroundSubtle,
    'titleBar.border': palette.border,

    'activityBar.background': palette.backgroundAlt,
    'activityBar.foreground': palette.foreground,
    'activityBar.inactiveForeground': palette.foregroundSubtle,
    'activityBar.activeBorder': palette.accent,
    'activityBar.activeBackground': opacity(palette.accent, softSelectionAlpha),
    'activityBar.border': palette.border,
    'activityBarBadge.background': palette.accent,
    'activityBarBadge.foreground': palette.background,

    'sideBar.background': palette.backgroundAlt,
    'sideBar.foreground': palette.foregroundMuted,
    'sideBar.border': palette.border,
    'sideBarSectionHeader.background': palette.backgroundAlt,
    'sideBarSectionHeader.foreground': palette.foreground,
    'sideBarSectionHeader.border': palette.border,
    'sideBarTitle.foreground': palette.foregroundMuted,

    'editorGroupHeader.tabsBackground': palette.backgroundAlt,
    'editorGroupHeader.tabsBorder': palette.border,
    'editorGroup.border': palette.border,

    'tab.activeBackground': palette.background,
    'tab.activeForeground': palette.foreground,
    'tab.activeBorderTop': palette.accent,
    'tab.inactiveBackground': palette.backgroundAlt,
    'tab.inactiveForeground': palette.foregroundSubtle,
    'tab.inactiveModifiedBorder': palette.git.modified,
    'tab.border': palette.border,
    'tab.unfocusedActiveBorderTop': opacity(palette.accent, 0.5),

    'editor.background': palette.background,
    'editor.foreground': palette.foreground,
    'editorLineNumber.foreground': palette.foregroundSubtle,
    'editorLineNumber.activeForeground': palette.foregroundMuted,
    'editorCursor.foreground': palette.accent,
    'editor.selectionBackground': opacity(palette.accent, selectionAlpha),
    'editor.inactiveSelectionBackground': opacity(palette.accent, softSelectionAlpha),
    'editor.selectionHighlightBackground': opacity(palette.accent, softSelectionAlpha),
    'editor.wordHighlightBackground': opacity(palette.accent, softSelectionAlpha),
    'editor.wordHighlightStrongBackground': opacity(palette.accent, selectionAlpha),
    'editor.findMatchBackground': opacity(palette.syntax.number, isDark ? 0.26 : 0.22),
    'editor.findMatchHighlightBackground': opacity(palette.syntax.number, softSelectionAlpha),
    'editor.findRangeHighlightBackground': opacity(palette.syntax.number, lineAlpha),
    'editor.lineHighlightBackground': opacity(palette.accent, lineAlpha),
    'editor.lineHighlightBorder': transparent,
    'editor.rangeHighlightBackground': opacity(palette.accent, lineAlpha),
    'editor.hoverHighlightBackground': opacity(palette.accent, lineAlpha),
    'editorWhitespace.foreground': opacity(palette.foregroundSubtle, 0.55),
    'editorIndentGuide.background1': opacity(palette.borderStrong, 0.35),
    'editorIndentGuide.activeBackground1': opacity(palette.borderStrong, 0.65),
    'editorRuler.foreground': opacity(palette.borderStrong, 0.4),

    'editorBracketMatch.background': opacity(palette.accent, softSelectionAlpha),
    'editorBracketMatch.border': palette.accent,
    'editorBracketHighlight.foreground1': bracketColors[0],
    'editorBracketHighlight.foreground2': bracketColors[1],
    'editorBracketHighlight.foreground3': bracketColors[2],
    'editorBracketHighlight.foreground4': bracketColors[3],
    'editorBracketHighlight.foreground5': bracketColors[4],
    'editorBracketHighlight.foreground6': bracketColors[5],
    'editorBracketHighlight.unexpectedBracket.foreground': palette.status.error,

    'editorGutter.background': palette.background,
    'editorGutter.addedBackground': palette.git.added,
    'editorGutter.modifiedBackground': palette.git.modified,
    'editorGutter.deletedBackground': palette.git.deleted,
    'editorGutter.foldingControlForeground': palette.foregroundSubtle,

    'editorHoverWidget.background': palette.surface,
    'editorHoverWidget.foreground': palette.foreground,
    'editorHoverWidget.border': palette.border,
    'editorHoverWidget.statusBarBackground': palette.backgroundMuted,

    'editorWidget.background': palette.surface,
    'editorWidget.foreground': palette.foreground,
    'editorWidget.border': palette.border,
    'editorWidget.resizeBorder': palette.accent,

    'editorSuggestWidget.background': palette.surface,
    'editorSuggestWidget.foreground': palette.foreground,
    'editorSuggestWidget.border': palette.border,
    'editorSuggestWidget.highlightForeground': palette.accent,
    'editorSuggestWidget.selectedBackground': opacity(palette.accent, softSelectionAlpha),
    'editorSuggestWidget.selectedForeground': palette.foreground,

    'editorError.foreground': palette.status.error,
    'editorWarning.foreground': palette.status.warning,
    'editorInfo.foreground': palette.status.info,
    'editorHint.foreground': palette.status.success,

    'diffEditor.insertedTextBackground': opacity(palette.status.success, softSelectionAlpha),
    'diffEditor.insertedLineBackground': opacity(palette.status.success, lineAlpha),
    'diffEditor.removedTextBackground': opacity(palette.status.error, softSelectionAlpha),
    'diffEditor.removedLineBackground': opacity(palette.status.error, lineAlpha),
    'diffEditor.diagonalFill': opacity(palette.foregroundSubtle, 0.15),

    'peekView.border': palette.borderStrong,
    'peekViewEditor.background': palette.background,
    'peekViewEditorGutter.background': palette.backgroundAlt,
    'peekViewResult.background': palette.backgroundAlt,
    'peekViewResult.matchHighlightBackground': opacity(palette.syntax.number, softSelectionAlpha),
    'peekViewTitle.background': palette.backgroundMuted,
    'peekViewTitleDescription.foreground': palette.foregroundMuted,
    'peekViewTitleLabel.foreground': palette.foreground,

    'panel.background': palette.backgroundAlt,
    'panel.border': palette.border,
    'panelTitle.activeForeground': palette.foreground,
    'panelTitle.inactiveForeground': palette.foregroundSubtle,
    'panelTitle.activeBorder': palette.accent,
    'panelInput.border': palette.border,

    'statusBar.background': palette.backgroundMuted,
    'statusBar.foreground': palette.foregroundMuted,
    'statusBar.border': palette.border,
    'statusBar.debuggingBackground': palette.syntax.number,
    'statusBar.debuggingForeground': palette.background,
    'statusBar.noFolderBackground': palette.backgroundMuted,
    'statusBarItem.hoverBackground': opacity(palette.accent, softSelectionAlpha),
    'statusBarItem.prominentBackground': opacity(palette.accent, softSelectionAlpha),
    'statusBarItem.prominentHoverBackground': opacity(palette.accent, selectionAlpha),

    'input.background': palette.surface,
    'input.foreground': palette.foreground,
    'input.border': palette.border,
    'input.placeholderForeground': palette.foregroundSubtle,

    'inputOption.activeBackground': opacity(palette.accent, softSelectionAlpha),
    'inputOption.activeBorder': palette.accent,
    'inputOption.activeForeground': palette.foreground,

    'inputValidation.errorBorder': palette.status.error,
    'inputValidation.errorBackground': opacity(palette.status.error, lineAlpha),
    'inputValidation.warningBorder': palette.status.warning,
    'inputValidation.warningBackground': opacity(palette.status.warning, lineAlpha),
    'inputValidation.infoBorder': palette.status.info,
    'inputValidation.infoBackground': opacity(palette.status.info, lineAlpha),

    'button.background': palette.accent,
    'button.foreground': palette.background,
    'button.hoverBackground': palette.accentHover,
    'button.secondaryBackground': palette.backgroundMuted,
    'button.secondaryForeground': palette.foreground,
    'button.secondaryHoverBackground': palette.surfaceHover,

    'dropdown.background': palette.surface,
    'dropdown.foreground': palette.foreground,
    'dropdown.border': palette.border,

    'list.activeSelectionBackground': opacity(palette.accent, softSelectionAlpha),
    'list.activeSelectionForeground': palette.foreground,
    'list.hoverBackground': opacity(palette.accent, lineAlpha),
    'list.hoverForeground': palette.foreground,
    'list.focusBackground': opacity(palette.accent, softSelectionAlpha),
    'list.focusForeground': palette.foreground,
    'list.inactiveSelectionBackground': opacity(palette.accent, lineAlpha),
    'list.inactiveSelectionForeground': palette.foreground,
    'list.highlightForeground': palette.accent,
    'list.errorForeground': palette.status.error,
    'list.warningForeground': palette.status.warning,

    'menu.background': palette.surface,
    'menu.foreground': palette.foreground,
    'menu.selectionBackground': opacity(palette.accent, softSelectionAlpha),
    'menu.selectionForeground': palette.foreground,
    'menu.separatorBackground': palette.border,

    'commandCenter.background': opacity(palette.accent, lineAlpha),
    'commandCenter.foreground': palette.foreground,
    'commandCenter.activeBackground': opacity(palette.accent, softSelectionAlpha),

    'notificationCenterHeader.background': palette.backgroundMuted,
    'notificationCenterHeader.foreground': palette.foreground,
    'notificationToast.background': palette.surface,
    'notifications.foreground': palette.foreground,
    'notifications.background': palette.surface,
    'notifications.border': palette.border,
    'notificationsErrorIcon.foreground': palette.status.error,
    'notificationsWarningIcon.foreground': palette.status.warning,
    'notificationsInfoIcon.foreground': palette.status.info,

    'badge.background': palette.backgroundMuted,
    'badge.foreground': palette.foreground,

    'progressBar.background': palette.accent,

    'minimap.background': palette.background,
    'minimap.findMatchHighlight': palette.syntax.number,
    'minimap.selectionHighlight': palette.accent,
    'minimap.errorHighlight': palette.status.error,
    'minimap.warningHighlight': palette.status.warning,
    'minimapSlider.background': opacity(palette.accent, lineAlpha),
    'minimapSlider.hoverBackground': opacity(palette.accent, softSelectionAlpha),
    'minimapSlider.activeBackground': opacity(palette.accent, selectionAlpha),

    'scrollbarSlider.background': opacity(palette.foregroundSubtle, 0.22),
    'scrollbarSlider.hoverBackground': opacity(palette.foregroundMuted, 0.34),
    'scrollbarSlider.activeBackground': opacity(palette.foregroundMuted, 0.48),

    'editorOverviewRuler.addedForeground': opacity(palette.git.added, 0.85),
    'editorOverviewRuler.modifiedForeground': opacity(palette.git.modified, 0.85),
    'editorOverviewRuler.deletedForeground': opacity(palette.git.deleted, 0.85),
    'editorOverviewRuler.errorForeground': opacity(palette.status.error, 0.85),
    'editorOverviewRuler.warningForeground': opacity(palette.status.warning, 0.85),
    'editorOverviewRuler.infoForeground': opacity(palette.status.info, 0.85),

    'problemsErrorIcon.foreground': palette.status.error,
    'problemsWarningIcon.foreground': palette.status.warning,
    'problemsInfoIcon.foreground': palette.status.info,

    'gitDecoration.addedResourceForeground': palette.git.added,
    'gitDecoration.modifiedResourceForeground': palette.git.modified,
    'gitDecoration.deletedResourceForeground': palette.git.deleted,
    'gitDecoration.untrackedResourceForeground': palette.git.added,
    'gitDecoration.ignoredResourceForeground': palette.foregroundSubtle,
    'gitDecoration.conflictingResourceForeground': palette.status.warning,

    'terminal.background': palette.background,
    'terminal.foreground': palette.foreground,
    'terminalCursor.foreground': palette.accent,
    'terminalCursor.background': palette.background,

    'terminal.ansiBlack': ansiColors.normal.black,
    'terminal.ansiRed': ansiColors.normal.red,
    'terminal.ansiGreen': ansiColors.normal.green,
    'terminal.ansiYellow': ansiColors.normal.yellow,
    'terminal.ansiBlue': ansiColors.normal.blue,
    'terminal.ansiMagenta': ansiColors.normal.magenta,
    'terminal.ansiCyan': ansiColors.normal.cyan,
    'terminal.ansiWhite': ansiColors.normal.white,
    'terminal.ansiBrightBlack': ansiColors.bright.black,
    'terminal.ansiBrightRed': ansiColors.bright.red,
    'terminal.ansiBrightGreen': ansiColors.bright.green,
    'terminal.ansiBrightYellow': ansiColors.bright.yellow,
    'terminal.ansiBrightBlue': ansiColors.bright.blue,
    'terminal.ansiBrightMagenta': ansiColors.bright.magenta,
    'terminal.ansiBrightCyan': ansiColors.bright.cyan,
    'terminal.ansiBrightWhite': ansiColors.bright.white,

    'textLink.foreground': palette.accent,
    'textLink.activeForeground': palette.accentHover,
    'textCodeBlock.background': palette.backgroundAlt,
    'textBlockQuote.background': palette.backgroundAlt,
    'textBlockQuote.border': palette.border,
    'textPreformat.foreground': palette.foregroundMuted,

    'breadcrumb.background': palette.background,
    'breadcrumb.foreground': palette.foregroundSubtle,
    'breadcrumb.activeSelectionForeground': palette.foreground,
    'breadcrumb.focusForeground': palette.accent,

    'settings.headerForeground': palette.foreground,
    'settings.modifiedItemIndicator': palette.accent,
    'settings.checkboxBackground': palette.surface,
    'settings.checkboxBorder': palette.border,
    'settings.dropdownBackground': palette.surface,
    'settings.dropdownBorder': palette.border,
    'settings.dropdownForeground': palette.foreground,
    'settings.numberInputBackground': palette.surface,
    'settings.numberInputForeground': palette.foreground,
    'settings.numberInputBorder': palette.border,
    'settings.textInputBackground': palette.surface,
    'settings.textInputForeground': palette.foreground,
    'settings.textInputBorder': palette.border,
  };
}
